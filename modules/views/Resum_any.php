
<?php
$a[1]= "Nombre d’altes de <br> prestacions d’assistent personal";
$a[2]= "Nombre de prestacions <br> assistent personal";
$a[3] = "Import total destinat a <br> prestacions ordinàries assistent personal";
$a[4] = "Import total destinat a <br> endarreriments per a la prestació <br> assistent personal";
$a[5] = "Import total destinat a <br> la prestació assistent personal, incloent <br> prestacions ordinàries i endarreriments";

$a[6]= "Nombre d’altes de prestacions <br> de vetllador no professional";
$a[7]= "Nombre de prestacions de <br> vetllador no professional";
$a[8] = "Import total destinat a <br> prestacions ordinàries de vetllador <br> no professional";
$a[9] = "Import total destinat a <br> endarreriments per a la prestació de <br> vetllador no professional";
$a[10] = "Import total destinat a <br> endarreriments (per falta de pressupost) <br> per a la prestació de vetllador no professional";
$a[11] = "Import total destinat a la <br> prestació de vetllador no professional, <br> incloent prestacions ordinàries i endarreriments";

$a[12] = "Nombre d’altes de prestacions <br> vinculades al servei";
$a[13] = "Nombre de prestacions <br> vinculades al servei";
$a[14] = "Import total destinat a <br> prestacions ordinàries per a les <br> prestacions vinculades al servei";
$a[15] = "Import total destinat a <br> endarreriments per a les prestacions <br> vinculades al servei";
$a[16] = "Import total destinat a <br> les prestacions vinculades al servei, <br> incloent prestacions ordinàries i endarreriments";


$b[1]="Prestacions";
$b[2]="Import total destinat a les <br> prestacions, incloent prestacions ordinàries i endarreriments (€)";
$b[3]="Mitjana d’import (€/usuari)";
$b[4]="Import total destinat a <br> endarreriments (€)";
$b[5]="Mitjana de l’import destinat <br> a endarreriments entre el nombre d’altes (€/usuaris)";
$b[6]="Nombre total d’altes (usuaris)";
$b[7]="Baixes en situació retinguda: <br> a l’espera que l’usuari respongui un <br> requeriment o que SSTT informi (usuaris)";
$b[8]="Nombre de baixes totals del sistema (usuaris)";

# baixes per defuncio
$b[9]="Nombre baixes per defunció (usuaris)";
$b[10]="Mitjana de temps que transcorre <br> des que es produeix una baixa per defunció fins <br> que aquesta es fa realment efectiva (dies)";
$b[11]="Mitjana de l’import per usuari difunt <br> cobrat indegudament a causa del retard entre la data <br> de baixa i el moment en què aquesta es fa efectiva (€/usuari)";
$b[12]="Import total pagat indegudament a difunts a<br> causa del retard entre la data de baixa i el <br> moment en què aquesta es fa efectiva (€)";

# baixes altres motius
$b[13]="Nombre baixes per tots els <br> altres motius diferents de la defunció (usuaris)";
$b[14]="Mitjana de temps que transcorre <br> des que es produeix una baixa fins que aquesta <br> es fa realment efectiva (dies)";
$b[15]="Mitjana de l’import per usuari <br> cobrat indegudament a causa del retard entre la data <br> de baixa i el moment en què aquesta es fa efectiva (€/usuari)";
$b[16]="Import total pagat indegudament a <br> causa del retard entre la data de baixa i el <br> moment en què aquesta es fa efectiva (€)";

# modificatives a la baixa
$b[17]="Nombre d’usuaris que canvien el seu <br> expedient a un import inferior a causa d’un canvi de situació personal <br> sense que canviï el tipus de prestació que reben (usuaris)";
$b[18]="Mitjana de temps que transcorre des que <br> es produeix una modificativa en què disminueix <br> l’import fins que aquesta es fa realment efectiva (dies)";
$b[19]="Mitjana de l’import total per usuari cobrat <br> indegudament a causa del retard entre el moment de la <br> modificativa i la data en què aquesta es fa efectiva (casos que minoren l’import) (€/usuari)";
$b[20]="Import total pagat indegudament a causa <br> del retard entre el moment de la modificativa <br> i la data en què aquesta es fa efectiva (casos que minoren l’import) (€)";

# modificatives a l'alça
$b[21]="Nombre d’usuaris que canvien el seu <br> expedient a un import superior a causa d’un canvi de situació personal <br> sense que canviï el tipus de prestació que reben (usuaris)";
$b[22]="Mitjana de temps que transcorre des que <br> es produeix una modificativa en què augmenta <br> l’import fins que aquesta es fa realment efectiva (dies)";
$b[23]="Mitjana de l’import per usuari pendent de pagament <br> a causa del retard entre el moment de la <br> modificativa i la data en què aquesta es fa efectiva (casos que augmenten l’import) (€/usuari)";
$b[24]="Import total pendent de pagament a causa <br> del retard entre el moment de la modificativa <br> i la data en què aquesta es fa efectiva (casos que augmenten l’import) (€)";

# CANVI RECURS a la baixa
$b[25]="Nombre d’usuaris que es donen de baixa <br> d’una prestació per passar a cobrar-ne una altra, reduint l’import que perceben (usuaris)";
$b[26]="Mitjana de temps que transcorre des que es <br> produeix una baixa de canvi de recurs fins que aquesta <br> es fa realment efectiva (casos que minoren l’import) (dies)";
$b[27]="Mitjana de l’import per usuari cobrat <br> indegudament a causa del retard entre el moment de la baixa <br> de recurs i la data en què aquesta es fa efectiva (casos que minoren import) (€/usuari)";
$b[28]="Import total pagat indegudament a causa <br> del retard entre el moment de la baixa i la <br> data en què aquesta es fa efectiva (casos que minoren import) (€)";

# CANVI RECURS  a l’alça
$b[29]="Nombre d’usuaris que es donen de baixa <br> d’una prestació per passar a cobrar-ne una altra, augmentant l’import que perceben (usuaris)";
$b[30]="Mitjana de temps que transcorre des que es <br> produeix una baixa de canvi de recurs fins que aquesta <br> es fa realment efectiva (casos que augmenten l’import) (dies)";
$b[31]="Mitjana de l’import per usuari pendent de pagament <br> a causa del retard entre el moment de la baixa <br> de recurs i la data en què aquesta es fa efectiva (casos que augmenten l’import) (€/usuari)";
$b[32]="Import total pendent de pagament a causa <br> del retard entre el moment de la baixa i la <br> data en què aquesta es fa efectiva (casos que augmenten import) (€)";

$b[33]="Nombre d’usuaris que cobren <br> endarreriments DCR (usuaris)";
$b[34]="Nombre total d’usuaris del sistema que <br> cobren una prestació o bé un endarreriment (usuaris)";
?>



<div class='container'>

    <h4 class='left' style='color: yellowgreen;margin-top: 3%; margin-left: -20rem'>Resum  <hr style='border-top: 1px solid yellowgreen; width:1200%'></h4>
    </br>
    </br>
    </br>
    </br>
    </br>
    
    <div class='row' style='margin-left: -20rem'>
        <table class='striped table2exel' id="TotalP" >

            <?php
            $f = fopen("../../scripts/any/Total.csv", "r");
            echo" <thead>
                <tr>
                    <th></th>
                    <th colspan='5' style='text-align: center; font-weight: 900'>Assistent Personal</th>
                    <th colspan='6' style='text-align: center'>Vetllador no Professional</th>
                    <th colspan='5' style='text-align: center'>Prestacions Vinculades al Servei</th>
                </tr>
            </thead>
            <tbody>";

            while (($line = fgetcsv($f)) !== false) {
                echo "<tr style='font-weight: bold text-decoration: underline border-left:2px black font-weight: 500 text-align: right'>";
                echo "<td >" . htmlspecialchars($line[0]) . "</td>";

                for ($i = 1;$i < count($line); $i++) {
                    if(is_numeric($line[$i])){
                        $cell1=number_format($line[$i],(int)$line[$i] == $line[$i] ? 0 : 2,"'",".");
                        echo "<td style='text-align: right'>" . htmlspecialchars($cell1) . "</td>";
                    } else{
                        $cell1=$line[$i];
                        echo "<td><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$a[$i]'  data-html='true' data-position='bottom'  >" . htmlspecialchars($cell1) . "</a></td>";
                    }
                };
            };
            fclose($f);
            ?>
            </tbody> </table>
    </div>



    <h4 class='left' style='color: yellowgreen;margin-top: 3%; margin-left: -20rem'>Lapad III (pel total de les prestacions) <hr style=' border-top: 1px solid yellowgreen; width:220%'></h4>
    <div class='row'>
        <table class='striped table2exel' style='display: block; overflow-x: auto; white-space: nowrap; width:90rem; margin-left: -12rem' id='Resum'>

            <?php
            $f = fopen("../../scripts/any/Resum.csv", "r");
            echo" 
           <tbody>";

            while (($line = fgetcsv($f)) !== false) {
                echo "<tr style='font-weight: bold text-decoration: underline border-left:2px black font-weight: 500 text-align: right'>";
                echo "<td class='headcol'>" . htmlspecialchars($line[0]) . "</td>";

                for ($i = 1;$i < count($line); $i++) {
                    if(is_numeric($line[$i])){
                        $cell1=number_format($line[$i],(int)$line[$i] == $line[$i] ? 0 : 2,"'",".");
                        echo "<td style='text-align: right'>" . htmlspecialchars($cell1) . "</td>";
                    } else{
                        $cell1=$line[$i];
                        echo "<td><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[$i]'  data-html='true'  data-position='bottom'>" . htmlspecialchars($cell1) . "</a></td>";
                       // echo "<td style='text-align: right'>" . htmlspecialchars($cell1) . "</td>";

                    }
                };
            };
            fclose($f);
            ?>
            </tbody>
        </table>
    </div>

    <h4 class='left' style='color: yellowgreen;margin-top: 3%; margin-left: -20rem'>Baixes, altes i modificatives (per cada una de les prestacions) <hr style=' border-top: 1px solid yellowgreen; width:140%'></h4>
    <div class='row'>
        <table class='striped' style='display: block; overflow-x: auto; white-space: nowrap; width:90rem; margin-left: -12rem' id='BAM'>

            <?php
            $f = fopen("../../scripts/any/BAM.csv", "r");
            echo" <thead>
                <tr>
                    <th colspan='7' style='font-weight: 900'><a class='tooltipped' data-delay='50' data-tooltip= '$b[5]' data-html='true'  data-position='bottom'>Mitjanes dels endarreriments</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' data-tooltip= '$b[6]' data-html='true' data-position='bottom'>Noves</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[7]' data-html='true'  data-position='bottom'>Número de retinguts</th>   
                                     
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[8]' data-html='true'  data-position='bottom'>Baixes totals</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[9]' data-html='true'  data-position='bottom'>Baixes per defunció</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[10]' data-html='true'  data-position='bottom'>Mitjana del temps de retard de les baixes per defunció (dies)</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[11]' data-html='true' data-position='bottom'>Mitjana de pagaments indeguts de les baixes per defunció (€/usuari)</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[12]' data-html='true'  data-position='bottom'>Total de pagaments indeguts de les baixes per defunció(€)</th>                    
                    
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[13]' data-html='true'  data-position='bottom'>Baixes per altres motius</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[14]' data-html='true'  data-position='bottom'>Mitjana del temps de retard de les baixes per altres motius (dies)</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[15]' data-html='true' data-position='bottom'>Mitjana de pagaments indeguts de les baixes per altres motius (€/usuari)</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[16]' data-html='true'  data-position='bottom'>Total de pagaments indeguts de les baixes per altres motius (€)</th>

                    <th colspan='6' style='text-align: center'>Modificatives</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[17]' data-html='true'  data-position='bottom'>Modificatives a la baixa</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[18]' data-html='true'  data-position='bottom'>Mitjana del temps de retard de les modificatives a la baixa (dies)</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[19]' data-html='true'  data-position='bottom'>Mitjana de pagaments indeguts de les modificatives a la baixa (€/usuari)</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[20]' data-html='true'  data-position='bottom'>Total de pagaments indeguts de les modificacions a la baixa (€)</th>
                    
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[21]' data-html='true'  data-position='bottom'>Modificatives a l'alça</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[22]' data-html='true'  data-position='bottom'>Mitjana del temps de retard de les modificatives a l'alça (dies)</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[23]' data-html='true'  data-position='bottom'>Mitjana de pagaments indeguts de les modificatives a l'alça (€/usuari)</th>
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[24]' data-html='true'  data-position='bottom'>Total de pagaments indeguts de les modificacions a l'alça (€)</th>
                    
                    <th colspan='2' style='text-align: center'>Canvis de recurs</th>
                    <th colspan='2' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[25]' data-html='true'  data-position='bottom'>Canvis de recurs a la baixa</th>
                    <th colspan='2' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[26]' data-html='true'  data-position='bottom'>Retard dels canvis de recurs a la baixa (dies)</th>
                    <th colspan='2' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[27]' data-html='true'  data-position='bottom'>Mitjana de pagaments ind per canvi de recurs a la baixa (€)</th>
                    <th colspan='2' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[28]' data-html='true'  data-position='bottom'>Pagaments indeguts dels canvis de recurs a la baixa (€)</th>
                    
                    <th colspan='2' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[29]' data-html='true'  data-position='bottom'>Canvis de recurs a l'alça </th>
                    <th colspan='2' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[30]' data-html='true'  data-position='bottom'>Retard dels canvis de recurs a l'alça (dies)</th>
                    <th colspan='2' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[31]' data-html='true'  data-position='bottom'>Mitjana de pagaments ind per canvi de recurs a l'alça (€/usuari)</th>
                    <th colspan='2' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[32]' data-html='true'  data-position='bottom'>Pagaments indeguts dels canvis de recurs a l'alça (€)</th>
                    
                    <th colspan='6' style='text-align: center'><a class='tooltipped' data-delay='50' style='color:black' data-tooltip= '$b[34]' data-html='true'  data-position='bottom'>Usuaris</th>

                </tr>
           </thead>
           <tbody>";


            while (($line = fgetcsv($f)) !== false) {
                echo "<tr style='font-weight: bold text-decoration: underline border-left:2px black font-weight: 500 text-align: right'>";
                echo "<td class='headcol'>" . htmlspecialchars($line[0]) . "</td>";

                for ($i = 1;$i < count($line); $i++) {
                    if(is_numeric($line[$i])){
                        $cell1=number_format($line[$i],(int)$line[$i] == $line[$i] ? 0 : 2,"'",".");
                        echo "<td style='text-align: right'>" . htmlspecialchars($cell1) . "</td>";
                    } else{
                        $cell1=$line[$i];
//                        echo "<td><a class='tooltipped' data-delay='50' style='color:black' data-tooltip="; echo($a[$i]); echo ">" . htmlspecialchars($cell1) . "</a></td>";
                        echo "<td style='text-align: right'>" . htmlspecialchars($cell1) . "</td>";

                    }
                };
            };
            fclose($f);
            ?>
            </tbody>
        </table>
    </div>
            
    

    <h5 class='left' style='color: yellowgreen;margin-top: 3%; margin-left: -20rem'>Descarregar: <button id="excel1" class="waves-effect waves-light btn-flat" onClick="tablesToExcel(['TotalP','Resum','BAM'],
    ['Resum Total','LapadIII total','LapadIII per prestacions'], 'LapadIII.xls', 'Excel')" ><i class="material-icons">system_update_alt</i></button></h5>



    <script>
        $(document).ready(function() {
            $('.tooltipped').tooltip({delay:50});
        });
    </script>

</div>
